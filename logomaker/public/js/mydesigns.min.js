
$(function () {
    $("head").append($("#allFonts").html()),
    1 == isLoggedIn(!0) ? doPost("/getPurchaseHistory", {}, function (a) {
        if (200 == a.status) {
            var b = $(".my-purchases-ul"),
                e = function (a) {
                    var c = a.title;
                    var size = "S:"+a.small+" M:"+a.medium+" L:"+a.large+" XL:"+a.xl+" XXL:"+a.doublexl;
                    var status = (a.status == "NOT_PRINTED")?"PROCESSING":(a.status == "PRINTING")?"PROCESSED":"SHIPPED";
                    
                    (! c || c.trim().length <= 0) && (c = ".");
                    var d = "/getMyOtherProductImage?id=" + a.url + "&random=" + Math.random();
                    if(a.coupan_applied == 1 || a.coupan_applied == '1')
                    a.price = a.new_price;
                    if(status == "SHIPPED"){
                        if(a.return_status == null){
                            var f = '<span class="my-logo-company" onclick="requestreturn('+a.id+')" style="cursor:pointer;color:red"><b>Request Return</b></span>';
                        }else{
                            var f = '<span class="my-logo-company">Return Status :<b>'+a.return_status+'</b></span>';
                        }
                    }else{
                        if(status == "PROCESSING"){
                            if(a.cancel_status == null){
                                var f = '<span class="my-logo-company" onclick="requestcancel('+a.id+')" style="cursor:pointer;color:red"><b>Request Cancel</b></span>';
                            }else{
                                var f = '<span class="my-logo-company">Cancel Status :<b>'+a.cancel_status+'</b></span>';
                            }
                        }else{
                            var f = '';
                        }
                    }
                    var e = '<li class="col-md-4 purchaseHistoryItem myOtherItems' + a.id + '"><span class="my-logos-list "><div id="svgPurOtherObject' + a.id + '"><img src="'+d+'"></div><span class="my-logo-company">' + c + '</span><span class="my-logo-company"> Price :' + a.price +' '+ size+'</span><span class="my-logo-company"> Delivery Status :' + status + '</span>'+f+'</span></li>';
                    b.append(e)
                    //updateJQSvgImage("#svgPurOtherObject" + a.id, d)
                };
            if (a.items.length > 0) {
                for (var f = 0; f < a.items.length; f++) 
                    $(".hist-count").text(" (" + a.items.length + ")"),
                    "LOGO" == a.items[f].type ? c(a.items[f]) : "BC" == a.items[f].type ? d(a.items[f]) : e(a.items[f]);
                
                $(".my-logos-list").hover(function () {
                    $(this).find(".flip-logo-template").show(),
                    $(this).find(".flip-card-template").show()
                }, function () {
                    $(this).find(".flip-logo-template").hide(),
                    $(this).find(".flip-card-template").hide()
                }),
                $("[data-toggle=tooltip]").tooltip()
            } else 
                $(".my-purchases-ul").text("No purchases made.")
            
        } else 
            $(".my-purchases-ul").text("No purchases made."),
            bootbox.alert("Error: " + a.msg)
        
    }, function (a) {
        $(".my-purchases-ul").text("No purchases made."),
        bootbox.alert("Server Error: Communication Failed.")
    }) : $(".my-purchases-ul").text("No purchases made.")
})

